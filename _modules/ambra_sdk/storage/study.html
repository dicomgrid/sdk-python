
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>ambra_sdk.storage.study &#8212; Ambra-SDK 0.0.1 documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for ambra_sdk.storage.study</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Storage study namespace.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BufferedReader</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">from</span> <span class="nn">box</span> <span class="kn">import</span> <span class="n">Box</span><span class="p">,</span> <span class="n">BoxList</span>
<span class="kn">from</span> <span class="nn">requests</span> <span class="kn">import</span> <span class="n">Response</span>

<span class="kn">from</span> <span class="nn">ambra_sdk.exceptions.storage</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">InconsistencyConflict</span><span class="p">,</span>
    <span class="n">PermissionDenied</span><span class="p">,</span>
    <span class="n">PreconditionFailed</span><span class="p">,</span>
    <span class="n">UnsupportedMediaType</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">ambra_sdk.storage.bool_to_int</span> <span class="kn">import</span> <span class="n">bool_to_int</span>
<span class="kn">from</span> <span class="nn">ambra_sdk.storage.response</span> <span class="kn">import</span> <span class="n">check_response</span>


<span class="k">def</span> <span class="nf">validate_size_x_string</span><span class="p">(</span><span class="n">size_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Validate size x string.</span>

<span class="sd">    :param size_str: size str in WxH format</span>

<span class="sd">    :raises ValueError: Wrong size value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">size_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Wrong size format&#39;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="nb">int</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Wrong width value&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">int</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Wrong height value&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">validate_size</span><span class="p">(</span><span class="n">size_str</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Validate size.</span>

<span class="sd">    :param size_str: size</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">size_str</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">try</span><span class="p">:</span>  <span class="c1"># NOQA:WPS229</span>
        <span class="nb">int</span><span class="p">(</span><span class="n">size_str</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">validate_size_x_string</span><span class="p">(</span><span class="n">size_str</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">ImageJsonBox</span><span class="p">(</span><span class="n">Box</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Image json box.</span>

<span class="sd">    Response object for image_json method</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Get tags by filter.</span>

<span class="sd">        :param filter_dict: dict for filtering</span>
<span class="sd">        :yields: tag</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;tags&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span>
                <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">filter_key</span><span class="p">)</span> <span class="o">==</span> <span class="n">filter_value</span>
                <span class="k">for</span> <span class="n">filter_key</span><span class="p">,</span> <span class="n">filter_value</span> <span class="ow">in</span> <span class="n">filter_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="k">yield</span> <span class="n">tag</span>

    <span class="k">def</span> <span class="nf">tag_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get tag by name.</span>

<span class="sd">        :param name: name of tag</span>
<span class="sd">        :returns: tag</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_tags</span><span class="p">(</span><span class="n">filter_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">}),</span>
            <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>


<span class="k">class</span> <span class="nc">JsonBox</span><span class="p">(</span><span class="n">BoxList</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Json box.</span>

<span class="sd">    Response object for json method.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Init.</span>

<span class="sd">        :param args: args</span>
<span class="sd">        :param kwargs: kwargs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
            <span class="n">box_class</span><span class="o">=</span><span class="n">ImageJsonBox</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>


<div class="viewcode-block" id="Study"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study">[docs]</a><span class="k">class</span> <span class="nc">Study</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Storage Study.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Init.</span>

<span class="sd">        :param storage: storage api</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span> <span class="o">=</span> <span class="n">storage</span>

<div class="viewcode-block" id="Study.schema"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.schema">[docs]</a>    <span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">extended</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachments_only</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">phi_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">use_box</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Box</span><span class="p">,</span> <span class="n">Response</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the schema of study.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/schema?sid={sid}&amp;phi_namespace={phi_namespace}&amp;extended={1,0}&amp;attachments_only={0,1}  # NOQA E501</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param extended: is an bool, when set to 1 will include</span>
<span class="sd">            the optional phi_version and transfer_attributes</span>
<span class="sd">            name/value pairs in the response.</span>
<span class="sd">        :param attachments_only: is an bool, when set to 1</span>
<span class="sd">            will only include a list of</span>
<span class="sd">            the attachments in the study.</span>
<span class="sd">        :param phi_namespace: A string, set to the UUID of the</span>
<span class="sd">            namespace where the file was attached if it was</span>
<span class="sd">            attached to a shared instance of the study</span>
<span class="sd">            outside of the original storage namespace</span>
<span class="sd">        :param use_box: Use box for response.</span>
<span class="sd">        :returns: study schema</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">extended</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">bool_to_int</span><span class="p">(</span><span class="n">extended</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">attachemtns_onlynt</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">bool_to_int</span><span class="p">(</span><span class="n">attachments_only</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/schema&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;phi_namespace&#39;</span><span class="p">,</span> <span class="s1">&#39;extended&#39;</span><span class="p">,</span> <span class="s1">&#39;attachments_only&#39;</span><span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">)</span>
        <span class="n">errors_mapping</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">409</span><span class="p">:</span> <span class="n">InconsistencyConflict</span><span class="p">(</span><span class="s1">&#39;An inconsistency is found while recomputing the schema cache. Retry the request after a short delay.&#39;</span><span class="p">)</span>  <span class="c1"># NOQA: 997</span>
        <span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span>
            <span class="n">response</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">errors_mapping</span><span class="o">=</span><span class="n">errors_mapping</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">use_box</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Box</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.delete"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">keep_attachments</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deletes a study.</span>

<span class="sd">        URL: /study/{namespace}/{study_uid}?sid={sid}&amp;keep_attachments={1,0}</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param keep_attachments: An integer value of 1 or 0.</span>

<span class="sd">        :returns: Delete response</span>

<span class="sd">        If the optional parameter keep_attachments is set to 1, then:</span>
<span class="sd">            all DICOM images will be deleted.</span>
<span class="sd">            reports and attachments related to the study will be kept.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keep_attachments</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">bool_to_int</span><span class="p">(</span><span class="n">keep_attachments</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;keep_attachments&#39;</span><span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.delete_image"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.delete_image">[docs]</a>    <span class="k">def</span> <span class="nf">delete_image</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">version</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deletes a study image.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/image/{imageUid}?sid={sid}&amp;version={image version hash}</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param image_uid: Image uid (Required).</span>
<span class="sd">        :param version: The image version hash</span>

<span class="sd">        :returns: Delete image response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/image/</span><span class="si">{image_uid}</span><span class="s1">&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_uid&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.count"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.count">[docs]</a>    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">images_only</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachments_only</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">count_files</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">use_box</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Box</span><span class="p">,</span> <span class="n">Response</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Gets study file count.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/count?sid={sid}&amp;images_only={1,0}&amp;attachments_only={1,0}&amp;count_files={1,0}</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param image_uid: Image uid (Required).</span>
<span class="sd">        :param images_only: an integer, zero or 1, returns the number</span>
<span class="sd">            of images in the study with superseded images by way of study update not counted.</span>
<span class="sd">        :param attachments_only: an integer, zero or 1, returns</span>
<span class="sd">            the number of attachments which have been added to this study.</span>
<span class="sd">        :param count_files: if present and set to 1 will count files stored</span>
<span class="sd">            on-disk for images and/or attachments,</span>
<span class="sd">            instead of counting from (possibly cached) meta data.</span>
<span class="sd">        :param use_box: Use box for response.</span>

<span class="sd">        :returns: count obj</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">images_only</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">bool_to_int</span><span class="p">(</span><span class="n">images_only</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">attachments_only</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">bool_to_int</span><span class="p">(</span><span class="n">attachments_only</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">count_files</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">bool_to_int</span><span class="p">(</span><span class="n">count_files</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/count&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span> <span class="s1">&#39;namespace&#39;</span><span class="p">,</span> <span class="s1">&#39;study_uid&#39;</span><span class="p">}</span>
        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;images_only&#39;</span><span class="p">,</span> <span class="s1">&#39;attachments_only&#39;</span><span class="p">,</span> <span class="s1">&#39;count_files&#39;</span><span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">use_box</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Box</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.tag"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.tag">[docs]</a>    <span class="k">def</span> <span class="nf">tag</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">phi_namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">use_box</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Box</span><span class="p">,</span> <span class="n">Response</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Gets study tags.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/tag?sid={sid}&amp;phi_namespace={phi_namespace}</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param phi_namespace: A string, set to the UUID of the</span>
<span class="sd">            namespace where the file was attached if</span>
<span class="sd">            it was attached to a shared instance of</span>
<span class="sd">            the study outside of the original storage namespace</span>
<span class="sd">        :param use_box: Use box for response.</span>

<span class="sd">        :returns: study tag object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/tag&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span> <span class="s1">&#39;namespace&#39;</span><span class="p">,</span> <span class="s1">&#39;study_uid&#39;</span><span class="p">}</span>
        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;phi_namespace&#39;</span><span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">use_box</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Box</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.attribute"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.attribute">[docs]</a>    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">phi_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">groups</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">include_tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">exclude_unnamed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">use_box</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Box</span><span class="p">,</span> <span class="n">Response</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Gets study image attributes.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/image/{imageUid}/version/{imageVersion}/attribute?sid={sid}&amp;phi_namespace={phi_namespace}</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param image_uid: Image uid (Required).</span>
<span class="sd">        :param image_version: Image version (Required).</span>
<span class="sd">        :param phi_namespace: A string, set to the UUID of the namespace</span>
<span class="sd">            where the file was attached if it was attached to a</span>
<span class="sd">            shared instance of the study outside of the original storage namespace</span>
<span class="sd">        :param groups: The groups parameter will allow the client to</span>
<span class="sd">            filter tags to only those in a certain set of top-level</span>
<span class="sd">            DICOM groups. Comma-separated list of decimal values, or</span>
<span class="sd">            hex values preceeded with &quot;0x&quot;.</span>
<span class="sd">        :param include_tags: Comma-separated list of top-level DICOM tags</span>
<span class="sd">            to include. Format: 00080018,00080020 Nested tags</span>
<span class="sd">            (00081111:00080550) only filter at the top level,</span>
<span class="sd">            everything is included within the sequence</span>
<span class="sd">        :param exclude_unnamed: A string containing &quot;1&quot; or &quot;0&quot; (default 0).</span>
<span class="sd">            When &quot;1&quot;, private tags (with &quot;name&quot;: &quot;?&quot;) are not included</span>
<span class="sd">        :param use_box: Use box for response.</span>

<span class="sd">        :returns: study attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/image/</span><span class="si">{image_uid}</span><span class="s1">/version/</span><span class="si">{image_version}</span><span class="s1">/attribute&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_version&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;phi_namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;groups&#39;</span><span class="p">,</span>
            <span class="s1">&#39;include_tags&#39;</span><span class="p">,</span>
            <span class="s1">&#39;exclude_unnamed&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">use_box</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Box</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.image_phi"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.image_phi">[docs]</a>    <span class="k">def</span> <span class="nf">image_phi</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">phi_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">use_box</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Box</span><span class="p">,</span> <span class="n">Response</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Gets study image PHI.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/image/{imageUid}/version/{imageVersion}/phi?sid={sid}&amp;phi_namespace={phi_namespace}</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param image_uid: Image uid (Required).</span>
<span class="sd">        :param image_version: Image version (Required).</span>
<span class="sd">        :param phi_namespace: A string, set to the UUID of the namespace where the file was attached if it was attached to a shared instance of the study outside of the original storage namespace</span>
<span class="sd">        :param use_box: Use box for response.</span>

<span class="sd">        :returns: image PHI object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/image/</span><span class="si">{image_uid}</span><span class="s1">/version/</span><span class="si">{image_version}</span><span class="s1">/phi&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_version&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;phi_namespace&#39;</span><span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">use_box</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Box</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.phi"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.phi">[docs]</a>    <span class="k">def</span> <span class="nf">phi</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">phi_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">use_box</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Box</span><span class="p">,</span> <span class="n">Response</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Gets study PHI data.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/phi?sid={sid}&amp;phi_namespace={phi_namespace}</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param phi_namespace: A string, set to the UUID of the namespace where the file was attached if it was attached to a shared instance of the study outside of the original storage namespace</span>
<span class="sd">        :param use_box: Use box for response.</span>

<span class="sd">        :returns: study PHI data object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/phi&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span> <span class="s1">&#39;namespace&#39;</span><span class="p">,</span> <span class="s1">&#39;study_uid&#39;</span><span class="p">}</span>
        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;phi_namespace&#39;</span><span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">use_box</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Box</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.thumbnail"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.thumbnail">[docs]</a>    <span class="k">def</span> <span class="nf">thumbnail</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">frame_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
        <span class="n">phi_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Gets study image thumbnail.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/image/{imageUid}/version/{imageVersion}/frame/{frameNumber}/thumbnail?sid={sid}&amp;depth={8,16}&amp;phi_namespace={phi_namespace}</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param image_uid: Image uid (Required).</span>
<span class="sd">        :param image_version: Image version (Required).</span>
<span class="sd">        :param frame_number: Frame number (Required).</span>
<span class="sd">        :param depth: Set the bit depth of the JPEG output (8 or 16).</span>
<span class="sd">        :param phi_namespace: A string, set to the UUID of the</span>
<span class="sd">            namespace where the file was attached if it was</span>
<span class="sd">            attached to a shared instance of the study</span>
<span class="sd">            outside of the original storage namespace</span>

<span class="sd">        :raises ValueError: Wrong value of depth</span>

<span class="sd">        :returns: Thumbnail object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">depth</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">}:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Depth must be in (8, 16)&#39;</span><span class="p">)</span>

        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/image/</span><span class="si">{image_uid}</span><span class="s1">/version/</span><span class="si">{image_version}</span><span class="s1">/frame/</span><span class="si">{frame_number}</span><span class="s1">/thumbnail&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_version&#39;</span><span class="p">,</span>
            <span class="s1">&#39;frame_number&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;depth&#39;</span><span class="p">,</span> <span class="s1">&#39;phi_namespace&#39;</span><span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">url</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">,</span>
            <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.diagnostic"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.diagnostic">[docs]</a>    <span class="k">def</span> <span class="nf">diagnostic</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">frame_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">phi_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
        <span class="n">size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Gets study diagnostic image.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/image/{imageUid}/version/{imageVersion}/frame/{frameNumber}/diagnostic?sid={sid}&amp;phi_namespace={phi_namespace}&amp;depth={8,16}&amp;size=[max-edge-length|{width}x{height}]</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param image_uid: Image uid (Required).</span>
<span class="sd">        :param image_version: Image version (Required).</span>
<span class="sd">        :param frame_number: Frame number (Required).</span>
<span class="sd">        :param phi_namespace: A string, set to the UUID of the namespace</span>
<span class="sd">            where the file was attached if it was attached to a shared</span>
<span class="sd">            instance of the study outside of the original storage namespace</span>
<span class="sd">        :param depth: Set the bit depth of the JPEG output (8 or 16).</span>
<span class="sd">        :param size: Specify size of output. Omitted or 0 indicates no</span>
<span class="sd">            change; one number sets the maximum edge length in pixels;</span>
<span class="sd">            wxh sets maximum width and height</span>

<span class="sd">        :raises ValueError: Wrongh depth or size param</span>

<span class="sd">        :returns: Diagnostic image object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">depth</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">}:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Depth must be in (8, 16)&#39;</span><span class="p">)</span>

        <span class="n">validate_size</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/image/</span><span class="si">{image_uid}</span><span class="s1">/version/</span><span class="si">{image_version}</span><span class="s1">/frame/</span><span class="si">{frame_number}</span><span class="s1">/diagnostic&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_version&#39;</span><span class="p">,</span>
            <span class="s1">&#39;frame_number&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;phi_namespace&#39;</span><span class="p">,</span> <span class="s1">&#39;depth&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">url</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">,</span>
            <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.frame"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.frame">[docs]</a>    <span class="k">def</span> <span class="nf">frame</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="c1"># TODO: frame number format</span>
        <span class="n">frame_number</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">phi_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
        <span class="n">quality</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span>
        <span class="n">size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Gets study image frame.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/image/{imageUid}/version/{imageVersion}/frame/{frameNumber:[0-9][0-9]*|[0-9][0-9]*}?sid={sid}&amp;phi_namespace={phi_namespace}&amp;depth={8,16}&amp;quality={0.0-1.0}&amp;size=[max-edge-length|{width}x{height}]</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param image_uid: Image uid (Required).</span>
<span class="sd">        :param image_version: Image version (Required).</span>
<span class="sd">        :param frame_number: Frame number (Required).</span>
<span class="sd">        :param phi_namespace: A string, set to the UUID of the namespace where the file was attached if it was attached to a shared instance of the study outside of the original storage namespace</span>
<span class="sd">        :param depth: Set the bit depth of the JPEG output (8 or 16).</span>
<span class="sd">        :param quality: Set the JPEG compression quality 0 &lt; q ≤ 1.0 (default 0.9)</span>
<span class="sd">        :param size: Specify size of output. Omitted or 0 indicates no change; one number sets the maximum edge length in pixels; wxh sets maximum width and height</span>

<span class="sd">        :raises ValueError: Wrongh depth or size param</span>

<span class="sd">        :returns: study image frame response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">depth</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">}:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Depth must be in (8, 16)&#39;</span><span class="p">)</span>
        <span class="n">validate_size</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/image/</span><span class="si">{image_uid}</span><span class="s1">/version/</span><span class="si">{image_version}</span><span class="s1">/frame/</span><span class="si">{frame_number}</span><span class="s1">&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_version&#39;</span><span class="p">,</span>
            <span class="s1">&#39;frame_number&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;phi_namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;depth&#39;</span><span class="p">,</span>
            <span class="s1">&#39;quality&#39;</span><span class="p">,</span>
            <span class="s1">&#39;size&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span></div>

<div class="viewcode-block" id="Study.frame_tiff"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.frame_tiff">[docs]</a>    <span class="k">def</span> <span class="nf">frame_tiff</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">frame_number</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">phi_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
        <span class="n">size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Gets study image frame as TIFF.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/image/{imageUid}/version/{imageVersion}/frame/{frameNumber:[0-9]*}/tiff?sid={sid}&amp;phi_namespace={phi_namespace}&amp;depth={8,16}&amp;size=[max-edge-length|{width}x{height}]</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param image_uid: Image uid (Required).</span>
<span class="sd">        :param image_version: Image version (Required).</span>
<span class="sd">        :param frame_number: Frame number (Required).</span>
<span class="sd">        :param phi_namespace: A string, set to the UUID of the namespace where the file was attached if it was attached to a shared instance of the study outside of the original storage namespace</span>
<span class="sd">        :param depth: Set the bit depth of the JPEG output (8 or 16).</span>
<span class="sd">        :param size: Specify size of output. Omitted or 0 indicates no change; one number sets the maximum edge length in pixels; wxh sets maximum width and height</span>

<span class="sd">        :raises ValueError: Wrongh depth or size param</span>

<span class="sd">        :returns: study image frame response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">depth</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">}:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Depth must be in (8, 16)&#39;</span><span class="p">)</span>
        <span class="n">validate_size</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/image/</span><span class="si">{image_uid}</span><span class="s1">/version/</span><span class="si">{image_version}</span><span class="s1">/frame/</span><span class="si">{frame_number}</span><span class="s1">/tiff&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_version&#39;</span><span class="p">,</span>
            <span class="s1">&#39;frame_number&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;phi_namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;depth&#39;</span><span class="p">,</span>
            <span class="s1">&#39;size&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span></div>

<div class="viewcode-block" id="Study.pdf"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.pdf">[docs]</a>    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Gets a study encapsulated pdf file.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/image/{imageUid}/version/{imageVersion}/pdf?sid={sid}</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param image_uid: Image uid (Required).</span>
<span class="sd">        :param image_version: Image version (Required).</span>

<span class="sd">        :returns: Pdf response object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/image/</span><span class="si">{image_uid}</span><span class="s1">/version/</span><span class="si">{image_version}</span><span class="s1">/pdf&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_version&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">request_arg_names</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">url</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">,</span>
            <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">errors_mapping</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">415</span><span class="p">:</span> <span class="n">UnsupportedMediaType</span><span class="p">(</span><span class="s1">&#39;Pdf was not found encapsulated in the DICOM file.&#39;</span><span class="p">)</span>  <span class="c1"># NOQA: 997</span>
        <span class="p">}</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span>
            <span class="n">response</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">errors_mapping</span><span class="o">=</span><span class="n">errors_mapping</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.image_json"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.image_json">[docs]</a>    <span class="k">def</span> <span class="nf">image_json</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">phi_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">exclude_unnamed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">all_dicom_values</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">use_box</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">ImageJsonBox</span><span class="p">,</span> <span class="n">Response</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Gets all DICOM attributes for an individual image.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/image/{imageUid}/version/{imageVersion}/json?sid={sid}&amp;phi_namespace={phi_namespace}</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param image_uid: Image uid (Required).</span>
<span class="sd">        :param image_version: Image version (Required).</span>
<span class="sd">        :param phi_namespace: A string, set to the UUID of</span>
<span class="sd">            the namespace where the file was attached if it</span>
<span class="sd">            was attached to a shared instance of the study</span>
<span class="sd">            outside of the original storage namespace</span>
<span class="sd">        :param exclude_unnamed: A string containing &quot;1&quot;</span>
<span class="sd">            or &quot;0&quot; (default 0). When &quot;1&quot;, private tags</span>
<span class="sd">            (with &quot;name&quot;: &quot;?&quot;) are not included</span>
<span class="sd">        :param all_dicom_values: A string containing &quot;1&quot;</span>
<span class="sd">            or &quot;0&quot; (default 0). When &quot;1&quot;, all values from</span>
<span class="sd">            a multi-value DICOM tag will be returned, separated</span>
<span class="sd">            by &quot;\&quot;. Otherwise, only the first value is returned</span>
<span class="sd">        :param use_box: Use box for response.</span>

<span class="sd">        :returns: DICOM attributes object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/image/</span><span class="si">{image_uid}</span><span class="s1">/version/</span><span class="si">{image_version}</span><span class="s1">/json&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_version&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;phi_namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;exclude_unnamed&#39;</span><span class="p">,</span>
            <span class="s1">&#39;all_dicom_values&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">use_box</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ImageJsonBox</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.json"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.json">[docs]</a>    <span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">phi_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">groups</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">include_tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">exclude_unnamed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">all_dicom_values</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">series_uid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">use_box</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">JsonBox</span><span class="p">,</span> <span class="n">Response</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Gets DICOM attributes for all images in a study.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/json?sid={sid}&amp;phi_namespace={phi_namespace}&amp;groups={group ids}&amp;include_tags={tags}</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param phi_namespace: A string, set to the UUID of</span>
<span class="sd">            the namespace where the file was attached if it</span>
<span class="sd">            was attached to a shared instance of the study</span>
<span class="sd">            outside of the original storage namespace</span>
<span class="sd">        :param groups: The groups parameter will allow the</span>
<span class="sd">            client to filter tags to only those in a certain</span>
<span class="sd">            set of top-level DICOM groups. Comma-separated list</span>
<span class="sd">            of decimal values, or hex values preceeded with &quot;0x&quot;.</span>
<span class="sd">        :param include_tags: Comma-separated list of top-level DICOM tags</span>
<span class="sd">            to include. Format: 00080018,00080020 Nested tags</span>
<span class="sd">            (00081111:00080550) only filter at the top level, everything</span>
<span class="sd">            is included within the sequence</span>
<span class="sd">        :param exclude_unnamed: A string containing &quot;1&quot; or &quot;0&quot;</span>
<span class="sd">            (default 0). When &quot;1&quot;, private tags (with &quot;name&quot;: &quot;?&quot;)</span>
<span class="sd">            are not included</span>
<span class="sd">        :param all_dicom_values: A string containing &quot;1&quot; or &quot;0&quot;</span>
<span class="sd">            (default 0). When &quot;1&quot;, all values from a multi-value</span>
<span class="sd">            DICOM tag will be returned, separated by &quot;\&quot;.</span>
<span class="sd">            Otherwise, only the first value is returned</span>
<span class="sd">        :param series_uid: A string containing a Series Instance UID.</span>
<span class="sd">            If specified, the results will only include DICOM tags</span>
<span class="sd">            from images from the specified series</span>
<span class="sd">        :param use_box: Use box for response.</span>

<span class="sd">        :returns: DICOM attributes object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/json&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;phi_namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;groups&#39;</span><span class="p">,</span>
            <span class="s1">&#39;include_tags&#39;</span><span class="p">,</span>
            <span class="s1">&#39;exclude_unnamed&#39;</span><span class="p">,</span>
            <span class="s1">&#39;all_dicom_values&#39;</span><span class="p">,</span>
            <span class="s1">&#39;series_uid&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">use_box</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">JsonBox</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.attachment"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.attachment">[docs]</a>    <span class="k">def</span> <span class="nf">attachment</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">attachment_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">phi_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Gets the selected attachment.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/attachment/{attachmentId}/version/{version}?sid={sid}&amp;phi_namespace={phi_namespace}</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param attachment_id: Attachment uid (Required).</span>
<span class="sd">        :param version: version (Required).</span>
<span class="sd">        :param phi_namespace: A string, set to the UUID of</span>
<span class="sd">            the namespace where the file was attached if it</span>
<span class="sd">            was attached to a shared instance of the study</span>
<span class="sd">            outside of the original storage namespace</span>

<span class="sd">        :returns: attachments response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/attachment/</span><span class="si">{attachment_id}</span><span class="s1">/version/</span><span class="si">{version}</span><span class="s1">&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;attachment_id&#39;</span><span class="p">,</span>
            <span class="s1">&#39;version&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;phi_namespace&#39;</span><span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">url</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">,</span>
            <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.latest"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.latest">[docs]</a>    <span class="k">def</span> <span class="nf">latest</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">phi_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Gets the latest attachment for a study.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/attachment/{filename:latest|latest}?sid={sid}&amp;phi_namespace={phi_namespace}</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param file_name: filename or latest (Required).</span>
<span class="sd">        :param phi_namespace: A string, set to the UUID of</span>
<span class="sd">            the namespace where the file was attached if it</span>
<span class="sd">            was attached to a shared instance of the study</span>
<span class="sd">            outside of the original storage namespace</span>

<span class="sd">        :returns: latest attachment response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/attachment/</span><span class="si">{file_name}</span><span class="s1">&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;file_name&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;phi_namespace&#39;</span><span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">url</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">,</span>
            <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.post_attachment"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.post_attachment">[docs]</a>    <span class="k">def</span> <span class="nf">post_attachment</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">opened_file</span><span class="p">:</span> <span class="n">BufferedReader</span><span class="p">,</span>
        <span class="n">phi_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">wrap_images</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">return_html</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">synchronous_wrap</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">static_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Posts an attachment to a study.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/attachment?sid={sid}&amp;phi_namespace={phi_namespace}&amp;wrap_images={0,1}&amp;return_html={0,1}&amp;synchronous_wrap={0,1}&amp;static_ids={0,1}</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param opened_file: Opened file (Required).</span>
<span class="sd">        :param phi_namespace: A string, set to the UUID of</span>
<span class="sd">            the namespace where the file was attached if it</span>
<span class="sd">            was attached to a shared instance of the study</span>
<span class="sd">            outside of the original storage namespace</span>
<span class="sd">        :param wrap_images: An integer of value 1 or 0.</span>
<span class="sd">            For attachments that are images, or can be rendered</span>
<span class="sd">            to an image, generate a new DICOM image in the study</span>
<span class="sd">            containing (a rendered image of) the attachment</span>
<span class="sd">            (also controlled by namespace setting auto_wrap_images).</span>
<span class="sd">        :param synchronous_wrap: An integer of value 1 or 0.</span>
<span class="sd">            If 1, do all processing for image wrapping before returning,</span>
<span class="sd">            including Services notifications.</span>
<span class="sd">        :param static_ids: An integer of value 1 or 0. If 1,</span>
<span class="sd">            the attachment, series and any images rendered from PDF</span>
<span class="sd">            are assigned (u)uids based on a hash of the attachment,</span>
<span class="sd">            which will be the same if the attachment is re-uploaded.</span>
<span class="sd">            The attachment is also allowed to be re-uploaded when set to 1.</span>
<span class="sd">        :param return_html: An integer of value 1 or 0. Return results as</span>
<span class="sd">            Content Type text html, instead of</span>
<span class="sd">            application json (required for certain browsers)</span>

<span class="sd">        :returns: posts attachments response</span>

<span class="sd">        The request entity must contain</span>
<span class="sd">        a single multipart/form-data element named</span>
<span class="sd">        data containing the content to be attached.</span>

<span class="sd">        If the optional parameter wrap_images or synchronous_wrap</span>
<span class="sd">        is set to 1, or the uploading account has the setting</span>
<span class="sd">        auto_wrap_images set to 1, then:</span>
<span class="sd">        attachments of type image/jpeg or image/bmp are, asynchronously</span>
<span class="sd">        (unless synchronous_wrap=1) to the Store Attachment request,</span>
<span class="sd">        posted to the Wrap Attachment service, to be stored as a single</span>
<span class="sd">        DICOM image in a new series within the specified study.</span>
<span class="sd">        attachments of type application/pdf are, asynchronously</span>
<span class="sd">        (unless synchronous_wrap=1) to the Store Attachment request,</span>
<span class="sd">        rendered to DICOM images at a resolution of 200 ppi,</span>
<span class="sd">        one image per page of the original PDF. The resulting are</span>
<span class="sd">        stored in a new series within the specified study.</span>
<span class="sd">        UIDs assigned to the series and images will be random unless static_ids=1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Attachment must be an image</span>
        <span class="n">wrap_images</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">bool_to_int</span><span class="p">(</span><span class="n">wrap_images</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">synchronous_wrap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">bool_to_int</span><span class="p">(</span><span class="n">synchronous_wrap</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">static_ids</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">bool_to_int</span><span class="p">(</span><span class="n">static_ids</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">return_html</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">bool_to_int</span><span class="p">(</span><span class="n">return_html</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

        <span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">opened_file</span><span class="p">}</span>

        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/attachment&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;phi_namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;wrap_images&#39;</span><span class="p">,</span>
            <span class="s1">&#39;return_html&#39;</span><span class="p">,</span>
            <span class="s1">&#39;synchronous_wrap&#39;</span><span class="p">,</span>
            <span class="s1">&#39;static_ids&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="n">url</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">,</span>
            <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span>
        <span class="c1"># Method can return Html (depends on params)...</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.download"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.download">[docs]</a>    <span class="k">def</span> <span class="nf">download</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">bundle</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">phi_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">series_uid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">image_uid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">include_wrapped_dicoms</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">stop_on_failure</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">exclude_viewer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Downloads a study ZIP file.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/download?sid={sid}&amp;phi_namespace={phi_namespace}&amp;bundle={iso,dicom,osx,win}&amp;include_wrapped_dicoms={0,1}&amp;series_uid={series_uid[,series_uid...]}&amp;image_uid={image_uid[,image_uid...]}</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param bundle: A string with value &quot;dicom&quot;, &quot;iso&quot;, &quot;osx&quot; or &quot;win&quot; (Required).</span>

<span class="sd">        :param phi_namespace: The shared-to namespace UUID</span>
<span class="sd">            of a shared instance of a study (Optional)</span>
<span class="sd">        :param include_wrapped_dicoms: When &quot;1&quot;, will also</span>
<span class="sd">            include the DICOM file of a wrapped DICOM.</span>
<span class="sd">            Default is to only include the unwrapped file.</span>
<span class="sd">        :param series_uid: One or more Series Instance UIDs,</span>
<span class="sd">            comma-separated. Download will only include images</span>
<span class="sd">            from these series.</span>
<span class="sd">        :param image_uid: One or more SOP Instance UIDs,</span>
<span class="sd">            comma-separated. Download will only include these images.</span>
<span class="sd">        :param stop_on_failure: If &quot;1&quot;, will not include the viewer</span>
<span class="sd">            app if there are any errors generating the download.</span>
<span class="sd">        :param exclude_viewer: If &quot;1&quot;, viewer app will not be</span>
<span class="sd">            included in the &quot;iso&quot;, &quot;osx&quot;, and &quot;win&quot; bundle.</span>
<span class="sd">            The viewer app can be retrieved separately via /download/viewer</span>

<span class="sd">        :raises ValueError: Wrong bundle value</span>

<span class="sd">        :returns: study zip file response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">bundle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;dicom&#39;</span><span class="p">,</span> <span class="s1">&#39;iso&#39;</span><span class="p">,</span> <span class="s1">&#39;osx&#39;</span><span class="p">,</span> <span class="s1">&#39;win&#39;</span><span class="p">}:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Boundle not in (&quot;dicom&quot;, &quot;iso&quot;, &quot;osx&quot;, &quot;win&quot;)&#39;</span><span class="p">)</span>

        <span class="n">include_wrapped_dicoms</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">bool_to_int</span><span class="p">(</span><span class="n">include_wrapped_dicoms</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">stop_on_failure</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">bool_to_int</span><span class="p">(</span><span class="n">stop_on_failure</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">exclude_viewer</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">bool_to_int</span><span class="p">(</span><span class="n">exclude_viewer</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/download&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;bundle&#39;</span><span class="p">,</span>
            <span class="s1">&#39;phi_namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;series_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;include_wrapped_dicoms&#39;</span><span class="p">,</span>
            <span class="s1">&#39;stop_on_failure&#39;</span><span class="p">,</span>
            <span class="s1">&#39;exclude_viewer&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">url</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">,</span>
            <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.delete_attachment"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.delete_attachment">[docs]</a>    <span class="k">def</span> <span class="nf">delete_attachment</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">attachment_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">hash_arg</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">phi_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deletes a study attachment.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/attachment/{attachmentId}/version/{hash}?sid={sid}?phi_namespace={phi_namespace}</span>

<span class="sd">        Note: Instead of hash in storage api this method accept hash_arg argument.</span>
<span class="sd">        Actually, hash_args is attachment version...</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param attachment_id: attachment id (Required).</span>
<span class="sd">        :param hash_arg: hash (Required).</span>
<span class="sd">        :param phi_namespace: A string, set to the UUID of the</span>
<span class="sd">            namespace where the file was attached if it was</span>
<span class="sd">            attached to a shared instance of the study outside of the original storage namespace</span>

<span class="sd">        :returns: Delete attachemnt response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/attachment/</span><span class="si">{attachment_id}</span><span class="s1">/version/</span><span class="si">{hash_arg}</span><span class="s1">&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;attachment_id&#39;</span><span class="p">,</span>
            <span class="s1">&#39;hash_arg&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;phi_namespace&#39;</span><span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>

        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.video"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.video">[docs]</a>    <span class="k">def</span> <span class="nf">video</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">reencode_video</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Gets a study encapsulated video.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/image/{imageUid}/version/{imageVersion}/video?sid={sid}&amp;reencode_video={0,1}</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param image_uid: Image uid (Required).</span>
<span class="sd">        :param image_version: Image version (Required).</span>
<span class="sd">        :param reencode_video: An integer of value 1 or 0.</span>

<span class="sd">        :returns: Video response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reencode_video</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">bool_to_int</span><span class="p">(</span><span class="n">reencode_video</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/image/</span><span class="si">{image_uid}</span><span class="s1">/version/</span><span class="si">{image_version}</span><span class="s1">/video&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image_version&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;reencode_video&#39;</span><span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>

        <span class="n">errors_mapping</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">415</span><span class="p">:</span> <span class="n">UnsupportedMediaType</span><span class="p">(</span><span class="s1">&#39;Video was not found encapsulated in the DICOM file.&#39;</span><span class="p">)</span>  <span class="c1"># NOQA: 997</span>
        <span class="p">}</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">url</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">,</span>
            <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span>
            <span class="n">response</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">errors_mapping</span><span class="o">=</span><span class="n">errors_mapping</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.split"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.split">[docs]</a>    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">phi_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">to_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">series_uid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">delete_series_from_original</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Split a study.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/split?sid={sid}&amp;phi_namespace={namespace}&amp;to_namespace={namespace}&amp;series_uid={series_uid,series_uid...series_uid}&amp;delete_series_from_original={0,1}</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param phi_namespace: An optional namespace UUID</span>
<span class="sd">            to burn-in PHI overrides to split study (defaults to no overrides)</span>
<span class="sd">        :param to_namespace: An optional namespace UUID to create</span>
<span class="sd">            the split study (defaults to current namespace)</span>
<span class="sd">        :param series_uid: An optional series instance uids list</span>
<span class="sd">            delimited by comas, only specified series will be split</span>
<span class="sd">            (defaults to split all image instances)</span>
<span class="sd">        :param delete_series_from_original: An integer value of either</span>
<span class="sd">            0 or 1. If 1 the series specified in the series_uid list will</span>
<span class="sd">            be deleted from the original study</span>

<span class="sd">        :returns: Split study response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/split&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;phi_namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;to_namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;series_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;delete_series_from_original&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span>
        <span class="c1"># new study uid</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.merge"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.merge">[docs]</a>    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">secondary_study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">delete_secondary_study</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">series_uids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Merge studies.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/merge?sid={sid}&amp;secondary_study_uid={secondary_study_uid}&amp;delete_secondary_study={0,1}</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param secondary_study_uid: The secondary study uid to be</span>
<span class="sd">            merged into the studyUid(Required).</span>
<span class="sd">        :param delete_secondary_study: An integer, when set to 1</span>
<span class="sd">            the process will check that the sid provided has the</span>
<span class="sd">            required permission to delete the secondary study.</span>
<span class="sd">        :param series_uids: A list of one or more comma-separated</span>
<span class="sd">            Series Instance UIDs, used to filter images merged</span>
<span class="sd">            from secondary study.</span>

<span class="sd">        :returns: Actually empty response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/merge&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;secondary_study_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;delete_secondary_study&#39;</span><span class="p">,</span>
            <span class="s1">&#39;series_uids&#39;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>

        <span class="n">permission_denied</span> <span class="o">=</span> <span class="n">PermissionDenied</span><span class="p">(</span>
            <span class="s1">&#39;the SID provided does not have the proper &#39;</span>
            <span class="s1">&#39;permission to delete the secondary study if &#39;</span>
            <span class="s1">&#39;the optional parameter delete_secondary_study &#39;</span>
            <span class="s1">&#39;is set to 1.&#39;</span>  <span class="c1"># NOQA: 1106</span>
        <span class="p">)</span>
        <span class="c1"># In api this code is 500...</span>
        <span class="n">permission_denied</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="mi">500</span>

        <span class="n">errors_mapping</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">500</span><span class="p">:</span> <span class="n">permission_denied</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span>
            <span class="n">response</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">errors_mapping</span><span class="o">=</span><span class="n">errors_mapping</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.anonymize"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.anonymize">[docs]</a>    <span class="k">def</span> <span class="nf">anonymize</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">region</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">to_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">new_study_uid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">keep_image_uids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">color</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Produce a new study that is a copy of the old, with specified pixel regions obscured.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/anonymize</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param region: Region (Required).</span>
<span class="sd">        :param to_namespace: The storage namespace</span>
<span class="sd">            into which the new study should be</span>
<span class="sd">            placed (default same as original).</span>
<span class="sd">        :param new_study_uid: The Study Instance UID of</span>
<span class="sd">            the new study (default is randomly generated).</span>
<span class="sd">        :param keep_image_uids: Should SOP Instance UIDs</span>
<span class="sd">            of modified copies be same as originals? (default is false)</span>
<span class="sd">        :param color: HTML-formatted color (rrggbb) of</span>
<span class="sd">            obscured regions (default is black-and-white checkerboard)</span>

<span class="sd">        :returns: Anonymize study response</span>

<span class="sd">        The request entity is a JSON object specifying the regions</span>
<span class="sd">        to be obscured. Regions may be specified at study, series,</span>
<span class="sd">        or instance level; but only the highest matching level</span>
<span class="sd">        containing a regions field will be used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/anonymize&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;to_namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;new_study_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;keep_image_uids&#39;</span><span class="p">,</span>
            <span class="s1">&#39;color&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json; charset=utf-8&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="n">url</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">region</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">errors_mapping</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">412</span><span class="p">:</span> <span class="n">PreconditionFailed</span><span class="p">(</span><span class="s1">&#39;phi_namespace or to_namespace is not provided.&#39;</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span>
            <span class="n">response</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">errors_mapping</span><span class="o">=</span><span class="n">errors_mapping</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.crop"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.crop">[docs]</a>    <span class="k">def</span> <span class="nf">crop</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">region</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">to_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">new_study_uid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">keep_image_uids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Produce a new study that is a copy of the old, cropped to specified pixel region.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/crop</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>
<span class="sd">        :param region: Region (Required).</span>
<span class="sd">        :param to_namespace: The storage namespace into</span>
<span class="sd">            which the new study should be placed</span>
<span class="sd">            (default: same as original).</span>
<span class="sd">        :param new_study_uid: The Study Instance UID</span>
<span class="sd">            of the new study (default: randomly generated).</span>
<span class="sd">        :param keep_image_uids: Should SOP Instance UIDs</span>
<span class="sd">            of modified copies be same as originals? 1/0</span>
<span class="sd">            (default: 0/false)</span>

<span class="sd">        :returns: Crop study response</span>

<span class="sd">        The request entity is a JSON object specifying the</span>
<span class="sd">        region to be cropped. Region may be specified at study,</span>
<span class="sd">        series, or instance level; but only the highest matching</span>
<span class="sd">        level containing a region field will be used.</span>
<span class="sd">        Example:</span>
<span class="sd">        { &quot;series&quot;:{ &quot;1.2.3.4.5&quot;:</span>
<span class="sd">        {&quot;region&quot;:{&quot;x&quot;:10,&quot;y&quot;:10, &quot;width&quot;:30, &quot;height&quot;:40}},</span>
<span class="sd">        &quot;1.3.5.7.9&quot;:{ &quot;instances&quot;:{ &quot;1.3.5.7.9.101&quot;:{&quot;region&quot;:</span>
<span class="sd">        {&quot;x&quot;:20,&quot;y&quot;:20, &quot;width&quot;:30, &quot;height&quot;:20} } } } }</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/crop&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">request_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;to_namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;new_study_uid&#39;</span><span class="p">,</span>
            <span class="s1">&#39;keep_image_uids&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json; charset=utf-8&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="n">url</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">region</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">errors_mapping</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">412</span><span class="p">:</span> <span class="n">PreconditionFailed</span><span class="p">(</span><span class="s1">&#39;phi_namespace or to_namespace is not provided.&#39;</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span>
            <span class="n">response</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">errors_mapping</span><span class="o">=</span><span class="n">errors_mapping</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Study.cache"><a class="viewcode-back" href="../../../referencies/storage_api.html#ambra_sdk.storage.study.Study.cache">[docs]</a>    <span class="k">def</span> <span class="nf">cache</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">engine_fqdn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">study_uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the image and metadata cache for the indicated study.</span>

<span class="sd">        URL: /study/{namespace}/{studyUid}/cache</span>

<span class="sd">        :param engine_fqdn: Engine FQDN (Required).</span>
<span class="sd">        :param namespace: Namespace (Required).</span>
<span class="sd">        :param study_uid: Study uid (Required).</span>

<span class="sd">        :returns: Cache study response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url_template</span> <span class="o">=</span> <span class="s1">&#39;/study/</span><span class="si">{namespace}</span><span class="s1">/</span><span class="si">{study_uid}</span><span class="s1">/cache&#39;</span>
        <span class="n">url_arg_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;engine_fqdn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;namespace&#39;</span><span class="p">,</span>
            <span class="s1">&#39;study_uid&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">request_arg_names</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">request_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">get_url_and_request</span><span class="p">(</span>
            <span class="n">url_template</span><span class="p">,</span>
            <span class="n">url_arg_names</span><span class="p">,</span>
            <span class="n">request_arg_names</span><span class="p">,</span>
            <span class="nb">locals</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_data</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">check_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">url_arg_names</span><span class="o">=</span><span class="n">url_arg_names</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">Ambra-SDK</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../referencies/index.html">Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Ambrahealth AI team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>